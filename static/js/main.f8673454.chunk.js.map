{"version":3,"sources":["search.worker.ts","Loading.tsx","Highlights.tsx","SearchBox.tsx","DataLoader.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["addMethods","methods","module","exports","w","Worker","name","Loading","text","progress","undefined","type","value","readOnly","min","max","step","Highlights","h","highlights","map","i","arr","substring","length","s","SearchBox","searchResults","search","useState","criteria","setCriteria","useEffect","onChange","e","target","r","href","searchResult","id","rel","require","DataLoader","setProgress","loading","setLoading","failed","setFailed","ready","setReady","workerInstance","setWorkerInstance","setSearchResults","addEventListener","data","t","params","console","error","init","onClick","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f8673454.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"init\",\"search\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"b39a5ea75d58676cc3ea.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","import React from 'react';\n\nfunction Loading({ text, progress }: { text: string | undefined, progress: number | undefined }) {\n  return (\n    <p>\n      {text || 'Loading...'}\n      <br />\n      {progress !== undefined && <input type=\"range\" value={progress * 1000} readOnly name=\"volume\" min=\"0\" max=\"1000\" step=\"1\" />}\n      {progress === undefined && 'unknown length'}\n    </p>\n  )\n}\n\nexport default Loading;\n","import React from 'react'\n\nexport interface HighlightsProps {\n  highlights: string[]\n}\n\nconst CONTEXT_LENGTH = 40\nconst Highlights: React.FunctionComponent<HighlightsProps> = ({ highlights }) => {\n  const h = highlights.map((h, i, arr) => {\n    if (i === 0) {\n      return h.substring(h.length-CONTEXT_LENGTH)\n    }\n    else if (i === arr.length - 1) {\n      return h.substring(0, CONTEXT_LENGTH)\n    } else if (i % 2 === 0) {\n      return h.substring(0, CONTEXT_LENGTH) + '...' + h.substring(h.length-CONTEXT_LENGTH)\n    }\n    return <b>{h}</b>\n  })\n\n  return (\n    <>\n      {h.map((s, i) => (<span key={i}>{s}</span>))}\n    </>\n  )\n}\n\nexport default Highlights\n","import React, { useState, useEffect } from 'react'\nimport { SearchResult } from 'minisearch'\nimport Highlights from './Highlights'\n\nexport interface SearchBoxProps {\n  searchResults: ExtendedSearchResult[]\n  search: (s: string) => void\n}\n\ninterface ExtendedSearchResult {\n  searchResult: SearchResult\n  text: string\n  highlights: string[]\n}\n\nconst SearchBox: React.FunctionComponent<SearchBoxProps> = ({ searchResults, search }) => {\n  const [criteria, setCriteria] = useState('')\n\n  useEffect(() => {\n    if (criteria.length < 3) {\n      return\n    }\n    search(criteria)\n  }, [criteria, search])\n\n  return (\n    <>\n      <input type=\"text\" value={criteria} onChange={(e) => setCriteria(e.target.value)} />\n      {searchResults.length > 0 && (<table><tbody>\n        {searchResults.map((r) => (\n          <tr key={r.searchResult.id}>\n            <td><a href={r.searchResult.id} target=\"_blank\" rel=\"noreferrer\">{r.searchResult['tender/description']}</a></td>\n            <td>{r.searchResult['tender/title']}</td>\n            <td>{r.searchResult['tender/description']}</td>\n            <td>\n              {r.searchResult['tender/value/currency']}\n              {r.searchResult['tender/value/amount']}\n            </td>\n            <td><Highlights highlights={r.highlights} /></td>\n          </tr>\n        ))}\n      </tbody></table>)}\n    </>\n  )\n}\n\nexport default SearchBox\n","import React, { useState, useEffect } from 'react'\n\nimport Loading from './Loading'\nimport SearchBox from './SearchBox'\n// eslint-disable-next-line import/no-webpack-loader-syntax\nconst Worker = require('workerize-loader!./search.worker')\n\nexport interface DataLoaderProps {\n}\n\nconst DataLoader : React.FunctionComponent<DataLoaderProps> = () => {\n  const [progress, setProgress] = useState<number>()\n  const [loading, setLoading] = useState(false)\n  const [failed, setFailed] = useState(false)\n  const [ready, setReady] = useState(false)\n  const [workerInstance, setWorkerInstance] = useState<any | null>(null)\n  const [searchResults, setSearchResults] = useState([])\n  const [criteria, setCriteria] = useState(\"\")\n\n  const retry = () => {\n    setProgress(0)\n    setFailed(false)\n    setLoading(false)\n    setReady(false)\n  }\n\n  useEffect(() => {\n    if (workerInstance) return\n    const w = new Worker()\n    setWorkerInstance(w)\n\n    w.addEventListener(\"message\", ({ data }: any) => {\n      // I don't know why `const [t, params] = data` does not work\n      const [t, params] = [data[0], data[1]]\n      if (!t) return\n      switch (t) {\n        case 'setFailed': setFailed(params); break\n        case 'setProgress': setProgress(params); break\n        case 'setReady': setReady(params); break\n        case 'setSearchResults': setSearchResults(params); break\n        default: console.error('unexpected message type: ' + t); break\n      }\n    })\n  }, [workerInstance])\n\n  useEffect(() => {\n    workerInstance?.search(criteria)\n  }, [criteria, workerInstance]);\n\n  useEffect(() => {\n    if (loading || !workerInstance) return;\n    setLoading(true);\n\n    workerInstance.init()\n  }, [loading, workerInstance])\n\n  return (\n    <>\n      {failed ?\n        (\n          <p>\n            Fall√≥ la descarga\n            <button onClick={() => retry()}>Reintentar</button>\n          </p>\n        ) :\n        (!ready ? <Loading text={progress === 1 ? 'Preparing...' : 'Downloading...'} progress={progress} /> : <SearchBox searchResults={searchResults} search={setCriteria} />)\n      }\n    </>\n  )\n}\nexport default DataLoader\n","import React, { useState } from 'react';\n\nimport DataLoader from './DataLoader'\n\nfunction App() {\n  const [ready, setReady] = useState(false)\n  return (\n    <>\n      {!ready && <button onClick={() => setReady(true)}>Listo para descargar muchos megas de datos</button>}\n      {ready && <DataLoader />}\n    </>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}